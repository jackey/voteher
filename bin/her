#!/usr/bin/env python
import sys
import os, os.path
import json

basepath = os.path.abspath(os.path.dirname(os.path.dirname(__file__)))

def last_her_id():
  her_dir = os.path.join(basepath, "her")
  if not os.path.isdir(her_dir):
    os.mkdir(her_dir)
    return 1
  else:
    max_her_id = 1
    paths = os.listdir(her_dir)
    for path in paths:
      her_id = int(path.split(".")[0].strip())
      if her_id > max_her_id:
        max_her_id = her_id
  return int(max_her_id) + 1

def new_her(name, images):
  new_her_id = last_her_id()
  her = {"name": name, "images": images, "point": 1, "id": new_her_id}
  her_json = json.dumps(her)
  
  her_dir = os.path.join(basepath, "her")
  with open(os.path.join(her_dir, str(new_her_id) + ".json"), "w+") as her_file:
    her_file.write(her_json)
  return True
  
if __name__ == "__main__":
  name = raw_input("Name: ")
  images = []
  while True:
    image = raw_input("Image: ")
    if image == "":
      break
    images.append(image)
    
  print "Begin to add new her"
  new_her(name, images)
  print "Added new her named [%s]" %(name)